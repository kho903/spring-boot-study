# 01. 마이크로미터 소개
- 서비스를 운영하는 개발자에게 서비스의 장애는 언제든지 발생할 수 있지만, 모니터링(경계)은 잘 대응하는 것이 중요.
- 서비스를 운영할 때는 애플리케이션의 CPU, 메모리, 커넥션 사용, 고객 요청수 같은 수 많은 지표들을 확인하는 것이 필요. 그래서 어디에 어떤 문제가 발생했는지
사전에 대응도 할 수 있고, 실제 문제가 발생해도 원인을 빠르게 파악해 대처 가능. 예를 들어 메모리 사용량이 가득 찼다면 메모리 문제와 관련있는 곳을 빠르게 찾아서
대응할 수 있을 것.
- 세상에는 수 많은 모니터링 툴이 있고, 시스템의 다양한 정보를 이 모니터링 툴에 전달해서 사용하게 됨.
  - 그라파나 대시보드, 핀포인트 등.
- 이런 모니터링 툴이 작동하려면 시스템의 다양한 지표들을 각각의 모니터링 툴에 맞도록 만들어서 보내주어야 함.
  - 실제로는 라이브러리 등을 통해서 자동화 되는 경우가 많음.

## 모니터링 툴에 지표 전달
- 예를 들어서 CPU, JVM, 커넥션 정보 등을 JMX 툴에 전달한다고 가정. 그러면 각각의 정보를 JMX 모니터링 툴이 정한 포맷에 맞추어 측정하고 전달해야 함.

## 모니터링 툴 변경
- 그런데 중간에 사용하는 모니터링 툴을 변경하면 어떻게 될까?
- 기존에 측정했던 코드를 모두 변경한 툴에 맞도록 다시 변경해야 함. 개발자 입장에서는 단순히 툴 하나를 변경했을 뿐인데, 측정하는 코드까지 모두 변경해야 하는
문제가 발생.
- 이런 문제를 해결하는 것이 바로 마이크로미터(Micrometer)라는 라이브러리.

## 마이크로미터 추상화 및 전체 그림.
- 마이크로미터는 애플리케이션 메트릭 파사드라고 불리는데, 애플리케이션의 메트릭(측정 지표)을 마이크로미터가 정한 표준 방법으로 모아서 제공해줌.
- 쉽게 이야기해서 마이크로미터가 추상화를 통해서 구현체를 쉽게 갈아끼울 수 있돌고 해 두었음.
- 보통은 스프링이 이런 추상화를 직접 만들어서 제공하지만, 마이크로미터라는 이미 잘 만들어진 추상화가 있기 때문에 스프링은 이것을 활용함. 스프링 부트 
액츄에이터는 마이크로미터를 기본으로 내장해서 사용함.
  - 로그를 추상화하는 `SLF4J`를 떠올려보면 쉽게 이해가 될 것.
- 개발자는 마이크로미터가 정한 표준 방법으로 메트릭(측정 지표)를 전달하면 됨. 그리고 사용하는 모니터링 툴에 맞는 구현체를 선택하면 됨. 이후에 모니터링 툴이
변경되어도 해당 구현체만 변경하면 됨. 애플리케이션 코드는 모니터링 툴이 변경되어도 그대로 유지 가능.
- 마이트로미터가 지원하는 모니터링 툴은 다음과 같음.
  - AppOptics, Atlas, CloudWatch, Datadog, Dynatrace, Elastic, Ganglia, Graphite, Humio, Influx, Instana, JMX, KairosDB,
    New Relic, Prometheus, SignalFx, Stackdriver, StatsD, Wavefront
- 참고 : 각 모니터링 툴에 대한 자세한 내용은 마이크로미터 공식 메뉴얼 참고
  - https://micrometer.io/docs
